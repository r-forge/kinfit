<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>mkinfit. mkin 0.9-27</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
  Johannes Ranke &lt;jranke@uni-bremen.de&gt;
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">mkin 0.9-27</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>
  Fit a kinetic model to data with one or more state variables.
</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>mkinfit(mkinmod, observed,  parms.ini&nbsp;=&nbsp;"auto", state.ini&nbsp;=&nbsp;c(100, rep(0, length(mkinmod$diffs) - 1)),  fixed_parms&nbsp;=&nbsp;NULL, fixed_initials&nbsp;=&nbsp;names(mkinmod$diffs)[-1],  solution_type&nbsp;=&nbsp;"auto", method.ode&nbsp;=&nbsp;"lsoda", method.modFit&nbsp;=&nbsp;"Marq", control.modFit&nbsp;=&nbsp;list(), transform_rates&nbsp;=&nbsp;TRUE, transform_fractions&nbsp;=&nbsp;TRUE, plot&nbsp;=&nbsp;FALSE, quiet&nbsp;=&nbsp;FALSE, err&nbsp;=&nbsp;NULL, weight&nbsp;=&nbsp;"none",  scaleVar&nbsp;=&nbsp;FALSE,  atol&nbsp;=&nbsp;1e-8, rtol&nbsp;=&nbsp;1e-10, n.outtimes&nbsp;=&nbsp;100,  reweight.method&nbsp;=&nbsp;NULL, reweight.tol&nbsp;=&nbsp;1e-8, reweight.max.iter&nbsp;=&nbsp;10, trace_parms&nbsp;=&nbsp;FALSE, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>mkinmod</dt>
      <dd>
    A list of class <code><a href='mkinmod.html'>mkinmod</a></code>, containing the kinetic model to be fitted to the data.
  </dd>
      <dt>observed</dt>
      <dd>
    The observed data. It has to be in the long format as described in
    <code>modFit</code>, i.e. the first column called "name" must contain the
    name of the observed variable for each data point. The second column must
    contain the times of observation, named "time".  The third column must be
    named "value" and contain the observed values. Optionally, a further column
    can contain weights for each data point. If it is not named "err", its name
    must be passed as a further argument named <code>err</code> which is then passed
    on to <code>modFit</code>.
  </dd>
      <dt>parms.ini</dt>
      <dd>
    A named vector of initial values for the parameters, including parameters
    to be optimised and potentially also fixed parameters as indicated by
    <code>fixed_parms</code>.  If set to "auto", initial values for rate constants
    are set to default values.  Using parameter names that are not in the model
    gives an error.

    It is possible to only specify a subset of the parameters that the model
    needs. You can use the parameter lists "bparms.ode" from a previously
    fitted model, which contains the differential equation parameters from this
    model. This works nicely if the models are nested. An example is given
    below.
  </dd>
      <dt>state.ini</dt>
      <dd>
    A named vector of initial values for the state variables of the model. In
    case the observed variables are represented by more than one model
    variable, the names will differ from the names of the observed variables
    (see <code>map</code> component of <code><a href='mkinmod.html'>mkinmod</a></code>). The default is to set
    the initial value of the first model variable to 100 and all others to 0.
  </dd>
      <dt>fixed_parms</dt>
      <dd>
    The names of parameters that should not be optimised but rather kept at the
    values specified in <code>parms.ini</code>.
  </dd>
      <dt>fixed_initials</dt>
      <dd>
    The names of model variables for which the initial state at time 0 should
    be excluded from the optimisation. Defaults to all state variables except
    for the first one.
  </dd>
      <dt>solution_type</dt>
      <dd>
    If set to "eigen", the solution of the system of differential equations is
    based on the spectral decomposition of the coefficient matrix in cases that
    this is possible. If set to "deSolve", a numerical ode solver from package
    <code>deSolve</code> is used. If set to "analytical", an analytical
    solution of the model is used. This is only implemented for simple
    degradation experiments with only one state variable, i.e. with no
    metabolites. The default is "auto", which uses "analytical" if possible,
    otherwise "eigen" if the model can be expressed using eigenvalues and
    eigenvectors, and finally "deSolve" for the remaining models (time
    dependence of degradation rates and metabolites). This argument is passed
    on to the helper function <code><a href='mkinpredict.html'>mkinpredict</a></code>.
  </dd>
      <dt>method.ode</dt>
      <dd>
    The solution method passed via <code><a href='mkinpredict.html'>mkinpredict</a></code> to
    <code>ode</code> in case the solution type is "deSolve". The default
    "lsoda" is performant, but sometimes fails to converge.
  </dd>
      <dt>method.modFit</dt>
      <dd>
    The optimisation method passed to <code>modFit</code>. The default "Marq"
    is the Levenberg Marquardt algorithm <code><a href='http://www.inside-r.org/packages/cran/minpack.lm/docs/nls.lm'>nls.lm</a></code> from the package
    <code>minpack.lm</code>. Often other methods need more iterations to find the
    same result. When using "Pseudo", "upper" and "lower" need to be 
    specified for the transformed parameters.
  </dd>
      <dt>control.modFit</dt>
      <dd>
    Additional arguments passed to the optimisation method used by
    <code>modFit</code>.
  </dd>
      <dt>transform_rates</dt>
      <dd>
    Boolean specifying if kinetic rate constants should be transformed in the
    model specification used in the fitting for better compliance with the
    assumption of normal distribution of the estimator. If TRUE, also 
    alpha and beta parameters of the FOMC model are log-transformed, as well 
    as k1 and k2 rate constants for the DFOP and HS models.
    If TRUE, zero is used as a lower bound for the rates in the optimisation.
  </dd>
      <dt>transform_fractions</dt>
      <dd>
    Boolean specifying if formation fractions constants should be transformed in the
    model specification used in the fitting for better compliance with the
    assumption of normal distribution of the estimator. The default (TRUE) is 
    to do transformations. The g parameter of the DFOP and HS models are also 
    transformed, as they can also be seen as compositional data. The
    transformation used for these transformations is the <code><a href='ilr.html'>ilr</a></code>
    transformation.
  </dd>
      <dt>plot</dt>
      <dd>
    Should the observed values and the numerical solutions be plotted at each
    stage of the optimisation?
  </dd>
      <dt>quiet</dt>
      <dd>
    Suppress printing out the current model cost after each improvement?
  </dd>
      <dt>err </dt>
      <dd>either <code>NULL</code>, or the name of the column with the
    <em>error</em> estimates, used to weigh the residuals (see details of
    <code>modCost</code>); if <code>NULL</code>, then the residuals are not weighed.
  </dd>
      <dt>weight</dt>
      <dd>
    only if <code>err</code>=<code>NULL</code>: how to weight the residuals, one of "none",
    "std", "mean", see details of <code>modCost</code>.
  </dd>
      <dt>scaleVar</dt>
      <dd>
    Will be passed to <code>modCost</code>. Default is not to scale Variables
    according to the number of observations.
  </dd>
      <dt>atol</dt>
      <dd>
    Absolute error tolerance, passed to <code>ode</code>. Default is 1e-8,
    lower than in <code>lsoda</code>.
  </dd>
      <dt>rtol</dt>
      <dd>
    Absolute error tolerance, passed to <code>ode</code>. Default is 1e-10,
    much lower than in <code>lsoda</code>.
  </dd>
      <dt>n.outtimes</dt>
      <dd>
    The length of the dataseries that is produced by the model prediction
    function <code><a href='mkinpredict.html'>mkinpredict</a></code>. This impacts the accuracy of
    the numerical solver if that is used (see <code>solution_type</code> argument. 
    The default value is 100.
  </dd>
      <dt>reweight.method</dt>
      <dd>
    The method used for iteratively reweighting residuals, also known
    as iteratively reweighted least squares (IRLS). Default is NULL,
    the other method implemented is called "obs", meaning that each
    observed variable is assumed to have its own variance, this is 
    estimated from the fit and used for weighting the residuals
    in each iteration until convergence of this estimate up to 
    <code>reweight.tol</code> or up to the maximum number of iterations
    specified by <code>reweight.max.iter</code>.
  </dd>
      <dt>reweight.tol</dt>
      <dd>
    Tolerance for convergence criterion for the variance components
    in IRLS fits.
  </dd>
      <dt>reweight.max.iter</dt>
      <dd>
    Maximum iterations in IRLS fits.
  </dd>
      <dt>trace_parms</dt>
      <dd>
    Should a trace of the parameter values be listed?
  </dd>
      <dt>...</dt>
      <dd>
    Further arguments that will be passed to <code>modFit</code>. 
  </dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>This function uses the Flexible Modelling Environment package
  <code>FME</code> to create a function calculating the model cost, i.e. the 
  deviation between the kinetic model and the observed data. This model cost is
  then minimised using the Levenberg-Marquardt algorithm <code><a href='http://www.inside-r.org/packages/cran/minpack.lm/docs/nls.lm'>nls.lm</a></code>, 
  using the specified initial or fixed parameters and starting values.
  In each step of the optimsation, the kinetic model is solved using the
  function <code><a href='mkinpredict.html'>mkinpredict</a></code>. The variance of the residuals for each
  observed variable can optionally be iteratively reweighted until convergence
  using the argument <code>reweight.method = "obs"</code>.</p>
  
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>A list with "mkinfit" and "modFit" in the class attribute. 
  A summary can be obtained by <code><a href='summary.mkinfit.html'>summary.mkinfit</a></code>.</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>
      
      <p>The implementation of iteratively reweighted least squares is inspired by the
  work of the KinGUII team at Bayer Crop Science (Walter Schmitt and Zhenglei
  Gao). A similar implemention can also be found in CAKE 2.0, which is the
  other GUI derivative of mkin, sponsored by Syngenta.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'># One parent compound, one metabolite, both single first order.
SFO_SFO &lt;- mkinmod(
  parent = list(type = &quot;SFO&quot;, to = &quot;m1&quot;, sink = TRUE),
  m1 = list(type = &quot;SFO&quot;))
# Fit the model to the FOCUS example dataset D using defaults
fit &lt;- mkinfit(SFO_SFO, FOCUS_2006_D)
</div>
<div class='output'>Model cost at call  1 :  19007.22 
Model cost at call  3 :  19007.22 
Model cost at call  7 :  10654.43 
Model cost at call  8 :  10654.43 
Model cost at call  10 :  10654.43 
Model cost at call  12 :  7167.609 
Model cost at call  14 :  7167.608 
Model cost at call  17 :  412.9611 
Model cost at call  18 :  412.9611 
Model cost at call  22 :  371.2211 
Model cost at call  23 :  371.2211 
Model cost at call  25 :  371.2211 
Model cost at call  27 :  371.2134 
Model cost at call  28 :  371.2134 
Model cost at call  30 :  371.2134 
Model cost at call  32 :  371.2134 
</div>
<div class='input'>summary(fit)
</div>
<div class='output'>mkin version:    0.9.27 
R version:       3.1.0 
Date of fit:     Thu May  8 08:28:13 2014 
Date of summary: Thu May  8 08:28:13 2014 

Equations:
[1] d_parent = - k_parent_sink * parent - k_parent_m1 * parent
[2] d_m1 = + k_parent_m1 * parent - k_m1_sink * m1            

Method used for solution of differential equation system:
eigen 

Weighting: none

Starting values for optimised parameters:
                 value   type transformed
parent_0      100.0000  state  100.000000
k_parent_sink   0.1000 deparm   -2.302585
k_parent_m1     0.1001 deparm   -2.301586
k_m1_sink       0.1002 deparm   -2.300587

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
              Estimate Std. Error  Lower   Upper t value  Pr(&gt;|t|)    Pr(&gt;t)
parent_0        99.600    1.61400 96.330 102.900   61.72 4.048e-38 2.024e-38
k_parent_sink   -3.038    0.07826 -3.197  -2.879  -38.82 5.602e-31 2.801e-31
k_parent_m1     -2.980    0.04124 -3.064  -2.897  -72.27 1.446e-40 7.228e-41
k_m1_sink       -5.248    0.13610 -5.523  -4.972  -38.56 7.083e-31 3.541e-31

Backtransformed parameters:
               Estimate     Lower     Upper
parent_0      99.600000 96.330000 1.029e+02
k_parent_sink  0.047920  0.040890 5.616e-02
k_parent_m1    0.050780  0.046700 5.521e-02
k_m1_sink      0.005261  0.003992 6.933e-03

Residual standard error: 3.211 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.398       4 15
parent     6.827       3  6
m1         4.490       1  9

Estimated disappearance times:
          DT50   DT90
parent   7.023  23.33
m1     131.761 437.70

Estimated formation fractions:
                ff
parent_sink 0.4855
parent_m1   0.5145
m1_sink     1.0000

Parameter correlation:
              parent_0 k_parent_sink k_parent_m1 k_m1_sink
parent_0       1.00000       0.60752    -0.06625   -0.1701
k_parent_sink  0.60752       1.00000    -0.08741   -0.6253
k_parent_m1   -0.06625      -0.08741     1.00000    0.4716
k_m1_sink     -0.17006      -0.62527     0.47164    1.0000

Data:
 time variable observed predicted   residual
    0   parent    99.46 9.960e+01 -1.385e-01
    0   parent   102.04 9.960e+01  2.442e+00
    1   parent    93.50 9.024e+01  3.262e+00
    1   parent    92.50 9.024e+01  2.262e+00
    3   parent    63.23 7.407e+01 -1.084e+01
    3   parent    68.99 7.407e+01 -5.083e+00
    7   parent    52.32 4.991e+01  2.408e+00
    7   parent    55.13 4.991e+01  5.218e+00
   14   parent    27.27 2.501e+01  2.257e+00
   14   parent    26.64 2.501e+01  1.627e+00
   21   parent    11.50 1.253e+01 -1.035e+00
   21   parent    11.64 1.253e+01 -8.946e-01
   35   parent     2.85 3.148e+00 -2.979e-01
   35   parent     2.91 3.148e+00 -2.379e-01
   50   parent     0.69 7.162e-01 -2.624e-02
   50   parent     0.63 7.162e-01 -8.624e-02
   75   parent     0.05 6.074e-02 -1.074e-02
   75   parent     0.06 6.074e-02 -7.382e-04
  100   parent       NA 5.151e-03         NA
  100   parent       NA 5.151e-03         NA
  120   parent       NA 7.155e-04         NA
  120   parent       NA 7.155e-04         NA
    0       m1     0.00 0.000e+00  0.000e+00
    0       m1     0.00 0.000e+00  0.000e+00
    1       m1     4.84 4.803e+00  3.704e-02
    1       m1     5.64 4.803e+00  8.370e-01
    3       m1    12.91 1.302e+01 -1.140e-01
    3       m1    12.96 1.302e+01 -6.400e-02
    7       m1    22.97 2.504e+01 -2.075e+00
    7       m1    24.47 2.504e+01 -5.748e-01
   14       m1    41.69 3.669e+01  5.000e+00
   14       m1    33.21 3.669e+01 -3.480e+00
   21       m1    44.37 4.165e+01  2.717e+00
   21       m1    46.44 4.165e+01  4.787e+00
   35       m1    41.22 4.331e+01 -2.093e+00
   35       m1    37.95 4.331e+01 -5.363e+00
   50       m1    41.19 4.122e+01 -2.831e-02
   50       m1    40.01 4.122e+01 -1.208e+00
   75       m1    40.09 3.645e+01  3.643e+00
   75       m1    33.85 3.645e+01 -2.597e+00
  100       m1    31.04 3.198e+01 -9.416e-01
  100       m1    33.13 3.198e+01  1.148e+00
  120       m1    25.15 2.879e+01 -3.640e+00
  120       m1    33.31 2.879e+01  4.520e+00
</div>
<div class='input'>
# Use stepwise fitting, using optimised parameters from parent only fit, FOMC
## &lt;strong&gt;Not run&lt;/strong&gt;: 
# FOMC &lt;- mkinmod(parent = list(type = &quot;FOMC&quot;))
# FOMC_SFO &lt;- mkinmod(
#   parent = list(type = &quot;FOMC&quot;, to = &quot;m1&quot;, sink = TRUE),
#   m1 = list(type = &quot;SFO&quot;))
# # Fit the model to the FOCUS example dataset D using defaults
# fit.FOMC_SFO &lt;- mkinfit(FOMC_SFO, FOCUS_2006_D)
# # Use starting parameters from parent only FOMC fit
# fit.FOMC = mkinfit(FOMC, FOCUS_2006_D, plot=TRUE)
# fit.FOMC_SFO &lt;- mkinfit(FOMC_SFO, FOCUS_2006_D, 
#   parms.ini = fit.FOMC$bparms.ode, plot=TRUE)
# 
# # Use stepwise fitting, using optimised parameters from parent only fit, SFORB
# SFORB &lt;- mkinmod(parent = list(type = &quot;SFORB&quot;))
# SFORB_SFO &lt;- mkinmod(
#   parent = list(type = &quot;SFORB&quot;, to = &quot;m1&quot;, sink = TRUE),
#   m1 = list(type = &quot;SFO&quot;))
# # Fit the model to the FOCUS example dataset D using defaults
# fit.SFORB_SFO &lt;- mkinfit(SFORB_SFO, FOCUS_2006_D)
# # Use starting parameters from parent only SFORB fit (not really needed in this case)
# fit.SFORB = mkinfit(SFORB, FOCUS_2006_D)
# fit.SFORB_SFO &lt;- mkinfit(SFORB_SFO, FOCUS_2006_D, parms.ini = fit.SFORB$bparms.ode)
# ## &lt;strong&gt;End(Not run)&lt;/strong&gt;

# Weighted fits, including IRLS
SFO_SFO.ff &lt;- mkinmod(parent = list(type = &quot;SFO&quot;, to = &quot;m1&quot;),
                      m1 = list(type = &quot;SFO&quot;), use_of_ff = &quot;max&quot;)
f.noweight &lt;- mkinfit(SFO_SFO.ff, FOCUS_2006_D)
</div>
<div class='output'>Model cost at call  1 :  18635.19 
Model cost at call  3 :  18635.19 
Model cost at call  5 :  18635.19 
Model cost at call  7 :  18059.44 
Model cost at call  8 :  18059.44 
Model cost at call  10 :  18059.44 
Model cost at call  13 :  6605.279 
Model cost at call  14 :  6605.279 
Model cost at call  16 :  6605.278 
Model cost at call  18 :  1067.272 
Model cost at call  19 :  1067.272 
Model cost at call  20 :  1067.272 
Model cost at call  24 :  1009.357 
Model cost at call  26 :  1009.357 
Model cost at call  29 :  1001.038 
Model cost at call  30 :  1001.038 
Model cost at call  33 :  1001.038 
Model cost at call  34 :  800.855 
Model cost at call  35 :  800.855 
Model cost at call  40 :  641.6486 
Model cost at call  41 :  641.6486 
Model cost at call  45 :  460.6378 
Model cost at call  46 :  460.6378 
Model cost at call  50 :  375 
Model cost at call  51 :  375 
Model cost at call  55 :  371.2136 
Model cost at call  56 :  371.2136 
Model cost at call  60 :  371.2134 
Model cost at call  61 :  371.2134 
Model cost at call  65 :  371.2134 
</div>
<div class='input'>summary(f.noweight)
</div>
<div class='output'>mkin version:    0.9.27 
R version:       3.1.0 
Date of fit:     Thu May  8 08:28:14 2014 
Date of summary: Thu May  8 08:28:14 2014 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: none

Starting values for optimised parameters:
                  value   type transformed
parent_0       100.0000  state 100.0000000
k_parent         0.1000 deparm  -2.3025851
f_parent_to_m1   0.2000 deparm  -0.9802581
k_m1             0.1001 deparm  -2.3015856

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
               Estimate Std. Error   Lower    Upper  t value  Pr(&gt;|t|)    Pr(&gt;t)
parent_0       99.60000    1.61400 96.3300 102.9000  61.7200 4.048e-38 2.024e-38
k_parent       -2.31600    0.04187 -2.4010  -2.2310 -55.3100 2.019e-36 1.010e-36
f_parent_to_m1  0.04096    0.06477 -0.0904   0.1723   0.6323 5.312e-01 2.656e-01
k_m1           -5.24800    0.13610 -5.5230  -4.9720 -38.5600 7.086e-31 3.543e-31

Backtransformed parameters:
                Estimate     Lower     Upper
parent_0       99.600000 96.330000 1.029e+02
k_parent        0.098700  0.090660 1.074e-01
f_parent_to_m1  0.514500  0.468100 5.606e-01
k_m1            0.005261  0.003992 6.933e-03

Residual standard error: 3.211 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.398       4 15
parent     6.459       2  7
m1         4.690       2  8

Estimated disappearance times:
          DT50   DT90
parent   7.023  23.33
m1     131.761 437.70

Parameter correlation:
               parent_0 k_parent f_parent_to_m1    k_m1
parent_0         1.0000   0.5178        -0.5489 -0.1701
k_parent         0.5178   1.0000        -0.5451 -0.3285
f_parent_to_m1  -0.5489  -0.5451         1.0000  0.7466
k_m1            -0.1701  -0.3285         0.7466  1.0000

Data:
 time variable observed  predicted   residual
    0   parent    99.46  9.960e+01 -1.385e-01
    0   parent   102.04  9.960e+01  2.442e+00
    1   parent    93.50  9.024e+01  3.262e+00
    1   parent    92.50  9.024e+01  2.262e+00
    3   parent    63.23  7.407e+01 -1.084e+01
    3   parent    68.99  7.407e+01 -5.083e+00
    7   parent    52.32  4.991e+01  2.408e+00
    7   parent    55.13  4.991e+01  5.218e+00
   14   parent    27.27  2.501e+01  2.257e+00
   14   parent    26.64  2.501e+01  1.627e+00
   21   parent    11.50  1.253e+01 -1.035e+00
   21   parent    11.64  1.253e+01 -8.946e-01
   35   parent     2.85  3.148e+00 -2.979e-01
   35   parent     2.91  3.148e+00 -2.379e-01
   50   parent     0.69  7.162e-01 -2.624e-02
   50   parent     0.63  7.162e-01 -8.624e-02
   75   parent     0.05  6.074e-02 -1.074e-02
   75   parent     0.06  6.074e-02 -7.382e-04
  100   parent       NA  5.151e-03         NA
  100   parent       NA  5.151e-03         NA
  120   parent       NA  7.155e-04         NA
  120   parent       NA  7.155e-04         NA
    0       m1     0.00 -7.105e-15  7.105e-15
    0       m1     0.00 -7.105e-15  7.105e-15
    1       m1     4.84  4.803e+00  3.704e-02
    1       m1     5.64  4.803e+00  8.370e-01
    3       m1    12.91  1.302e+01 -1.140e-01
    3       m1    12.96  1.302e+01 -6.400e-02
    7       m1    22.97  2.504e+01 -2.075e+00
    7       m1    24.47  2.504e+01 -5.748e-01
   14       m1    41.69  3.669e+01  5.000e+00
   14       m1    33.21  3.669e+01 -3.480e+00
   21       m1    44.37  4.165e+01  2.717e+00
   21       m1    46.44  4.165e+01  4.787e+00
   35       m1    41.22  4.331e+01 -2.093e+00
   35       m1    37.95  4.331e+01 -5.363e+00
   50       m1    41.19  4.122e+01 -2.831e-02
   50       m1    40.01  4.122e+01 -1.208e+00
   75       m1    40.09  3.645e+01  3.643e+00
   75       m1    33.85  3.645e+01 -2.597e+00
  100       m1    31.04  3.198e+01 -9.416e-01
  100       m1    33.13  3.198e+01  1.148e+00
  120       m1    25.15  2.879e+01 -3.640e+00
  120       m1    33.31  2.879e+01  4.520e+00
</div>
<div class='input'>f.irls &lt;- mkinfit(SFO_SFO.ff, FOCUS_2006_D, reweight.method = &quot;obs&quot;)
</div>
<div class='output'>Model cost at call  1 :  18635.19 
Model cost at call  3 :  18635.19 
Model cost at call  5 :  18635.19 
Model cost at call  7 :  18059.44 
Model cost at call  8 :  18059.44 
Model cost at call  10 :  18059.44 
Model cost at call  13 :  6605.279 
Model cost at call  14 :  6605.279 
Model cost at call  16 :  6605.278 
Model cost at call  18 :  1067.272 
Model cost at call  19 :  1067.272 
Model cost at call  20 :  1067.272 
Model cost at call  24 :  1009.357 
Model cost at call  26 :  1009.357 
Model cost at call  29 :  1001.038 
Model cost at call  30 :  1001.038 
Model cost at call  33 :  1001.038 
Model cost at call  34 :  800.855 
Model cost at call  35 :  800.855 
Model cost at call  40 :  641.6486 
Model cost at call  41 :  641.6486 
Model cost at call  45 :  460.6378 
Model cost at call  46 :  460.6378 
Model cost at call  50 :  375 
Model cost at call  51 :  375 
Model cost at call  55 :  371.2136 
Model cost at call  56 :  371.2136 
Model cost at call  60 :  371.2134 
Model cost at call  61 :  371.2134 
Model cost at call  65 :  371.2134 
IRLS based on variance estimates for each observed variable
Initial variance estimates are:
   parent        m1 
11.552580  7.421227 
Model cost at call  66 :  40 
Model cost at call  69 :  40 
Model cost at call  72 :  39.99278 
Model cost at call  73 :  39.99278 
Model cost at call  74 :  39.99278 
Model cost at call  77 :  39.99278 
Iteration 1 yields variance estimates:
   parent        m1 
11.573171  7.407969 
Sum of squared differences to last variance estimates: 1.5e-05 
Iteration 2 yields variance estimates:
   parent        m1 
11.573405  7.407846 
Sum of squared differences to last variance estimates: 1.7e-09 
</div>
<div class='input'>summary(f.irls)
</div>
<div class='output'>mkin version:    0.9.27 
R version:       3.1.0 
Date of fit:     Thu May  8 08:28:15 2014 
Date of summary: Thu May  8 08:28:15 2014 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: none then iterative reweighting method obs

Starting values for optimised parameters:
                  value   type transformed
parent_0       100.0000  state 100.0000000
k_parent         0.1000 deparm  -2.3025851
f_parent_to_m1   0.2000 deparm  -0.9802581
k_m1             0.1001 deparm  -2.3015856

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
               Estimate Std. Error    Lower   Upper  t value  Pr(&gt;|t|)    Pr(&gt;t)
parent_0       99.67000    1.79200 96.04000 103.300  55.6300 1.636e-36 8.182e-37
k_parent       -2.31200    0.04560 -2.40400  -2.220 -50.7000 4.446e-35 2.223e-35
f_parent_to_m1  0.03785    0.06318 -0.09027   0.166   0.5992 5.528e-01 2.764e-01
k_m1           -5.25100    0.12510 -5.50500  -4.998 -41.9900 3.521e-32 1.760e-32

Backtransformed parameters:
               Estimate     Lower     Upper
parent_0       99.67000 96.040000 1.033e+02
k_parent        0.09906  0.090310 1.087e-01
f_parent_to_m1  0.51340  0.468100 5.584e-01
k_m1            0.00524  0.004066 6.753e-03

Residual standard error: 1.054 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.399       4 15
parent     6.466       2  7
m1         4.679       2  8

Estimated disappearance times:
          DT50   DT90
parent   6.997  23.24
m1     132.282 439.43

Parameter correlation:
               parent_0 k_parent f_parent_to_m1    k_m1
parent_0         1.0000   0.5083        -0.6148 -0.1979
k_parent         0.5083   1.0000        -0.6062 -0.3894
f_parent_to_m1  -0.6148  -0.6062         1.0000  0.7417
k_m1            -0.1979  -0.3894         0.7417  1.0000

Data:
 time variable observed  predicted   residual err.irls
    0   parent    99.46  9.967e+01 -2.122e-01    3.402
    0   parent   102.04  9.967e+01  2.368e+00    3.402
    1   parent    93.50  9.027e+01  3.228e+00    3.402
    1   parent    92.50  9.027e+01  2.228e+00    3.402
    3   parent    63.23  7.405e+01 -1.082e+01    3.402
    3   parent    68.99  7.405e+01 -5.056e+00    3.402
    7   parent    52.32  4.982e+01  2.499e+00    3.402
    7   parent    55.13  4.982e+01  5.309e+00    3.402
   14   parent    27.27  2.490e+01  2.367e+00    3.402
   14   parent    26.64  2.490e+01  1.737e+00    3.402
   21   parent    11.50  1.245e+01 -9.477e-01    3.402
   21   parent    11.64  1.245e+01 -8.077e-01    3.402
   35   parent     2.85  3.110e+00 -2.600e-01    3.402
   35   parent     2.91  3.110e+00 -2.000e-01    3.402
   50   parent     0.69  7.037e-01 -1.375e-02    3.402
   50   parent     0.63  7.037e-01 -7.375e-02    3.402
   75   parent     0.05  5.913e-02 -9.134e-03    3.402
   75   parent     0.06  5.913e-02  8.661e-04    3.402
  100   parent       NA  4.969e-03         NA    3.402
  100   parent       NA  4.969e-03         NA    3.402
  120   parent       NA  6.852e-04         NA    3.402
  120   parent       NA  6.852e-04         NA    3.402
    0       m1     0.00 -7.105e-15  7.105e-15    2.722
    0       m1     0.00 -7.105e-15  7.105e-15    2.722
    1       m1     4.84  4.813e+00  2.672e-02    2.722
    1       m1     5.64  4.813e+00  8.267e-01    2.722
    3       m1    12.91  1.305e+01 -1.378e-01    2.722
    3       m1    12.96  1.305e+01 -8.779e-02    2.722
    7       m1    22.97  2.508e+01 -2.106e+00    2.722
    7       m1    24.47  2.508e+01 -6.061e-01    2.722
   14       m1    41.69  3.671e+01  4.983e+00    2.722
   14       m1    33.21  3.671e+01 -3.497e+00    2.722
   21       m1    44.37  4.165e+01  2.719e+00    2.722
   21       m1    46.44  4.165e+01  4.789e+00    2.722
   35       m1    41.22  4.329e+01 -2.069e+00    2.722
   35       m1    37.95  4.329e+01 -5.339e+00    2.722
   50       m1    41.19  4.119e+01 -3.388e-03    2.722
   50       m1    40.01  4.119e+01 -1.183e+00    2.722
   75       m1    40.09  3.644e+01  3.652e+00    2.722
   75       m1    33.85  3.644e+01 -2.588e+00    2.722
  100       m1    31.04  3.199e+01 -9.497e-01    2.722
  100       m1    33.13  3.199e+01  1.140e+00    2.722
  120       m1    25.15  2.881e+01 -3.659e+00    2.722
  120       m1    33.31  2.881e+01  4.501e+00    2.722
</div>
<div class='input'>f.w.mean &lt;- mkinfit(SFO_SFO.ff, FOCUS_2006_D, weight = &quot;mean&quot;)
</div>
<div class='output'>Model cost at call  1 :  24.38274 
Model cost at call  3 :  24.38274 
Model cost at call  5 :  24.38274 
Model cost at call  7 :  23.62652 
Model cost at call  8 :  23.62652 
Model cost at call  10 :  23.62652 
Model cost at call  13 :  9.539918 
Model cost at call  14 :  9.539918 
Model cost at call  16 :  9.539918 
Model cost at call  18 :  1.339285 
Model cost at call  19 :  1.339285 
Model cost at call  20 :  1.339285 
Model cost at call  24 :  1.151215 
Model cost at call  26 :  1.151215 
Model cost at call  29 :  1.126803 
Model cost at call  30 :  1.126803 
Model cost at call  31 :  1.126803 
Model cost at call  34 :  0.9833148 
Model cost at call  35 :  0.9833148 
Model cost at call  40 :  0.8516604 
Model cost at call  41 :  0.8516604 
Model cost at call  44 :  0.8516604 
Model cost at call  45 :  0.602075 
Model cost at call  46 :  0.602075 
Model cost at call  50 :  0.3871767 
Model cost at call  51 :  0.3871767 
Model cost at call  55 :  0.3478134 
Model cost at call  56 :  0.3478134 
Model cost at call  60 :  0.347807 
Model cost at call  61 :  0.347807 
Model cost at call  65 :  0.347807 
</div>
<div class='input'>summary(f.w.mean)
</div>
<div class='output'>mkin version:    0.9.27 
R version:       3.1.0 
Date of fit:     Thu May  8 08:28:16 2014 
Date of summary: Thu May  8 08:28:16 2014 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: mean

Starting values for optimised parameters:
                  value   type transformed
parent_0       100.0000  state 100.0000000
k_parent         0.1000 deparm  -2.3025851
f_parent_to_m1   0.2000 deparm  -0.9802581
k_m1             0.1001 deparm  -2.3015856

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
               Estimate Std. Error    Lower    Upper t value  Pr(&gt;|t|)    Pr(&gt;t)
parent_0        99.7300    1.93200 95.81000 103.6000  51.630 2.332e-35 1.166e-35
k_parent        -2.3090    0.04837 -2.40700  -2.2110 -47.730 3.779e-34 1.889e-34
f_parent_to_m1   0.0354    0.06344 -0.09327   0.1641   0.558 5.803e-01 2.901e-01
k_m1            -5.2550    0.12070 -5.49900  -5.0100 -43.540 9.764e-33 4.882e-33

Backtransformed parameters:
                Estimate    Lower     Upper
parent_0       99.730000 95.81000 1.036e+02
k_parent        0.099360  0.09007 1.096e-01
f_parent_to_m1  0.512500  0.46710 5.578e-01
k_m1            0.005224  0.00409 6.672e-03

Residual standard error: 0.09829 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.401       4 15
parent     6.473       2  7
m1         4.671       2  8

Estimated disappearance times:
          DT50   DT90
parent   6.976  23.18
m1     132.696 440.81

Parameter correlation:
               parent_0 k_parent f_parent_to_m1    k_m1
parent_0         1.0000   0.5004        -0.6514 -0.2143
k_parent         0.5004   1.0000        -0.6383 -0.4282
f_parent_to_m1  -0.6514  -0.6383         1.0000  0.7390
k_m1            -0.2143  -0.4282         0.7390  1.0000

Data:
 time variable observed  predicted   residual
    0   parent    99.46  9.973e+01 -2.706e-01
    0   parent   102.04  9.973e+01  2.309e+00
    1   parent    93.50  9.030e+01  3.202e+00
    1   parent    92.50  9.030e+01  2.202e+00
    3   parent    63.23  7.403e+01 -1.080e+01
    3   parent    68.99  7.403e+01 -5.035e+00
    7   parent    52.32  4.975e+01  2.572e+00
    7   parent    55.13  4.975e+01  5.382e+00
   14   parent    27.27  2.482e+01  2.454e+00
   14   parent    26.64  2.482e+01  1.824e+00
   21   parent    11.50  1.238e+01 -8.788e-01
   21   parent    11.64  1.238e+01 -7.388e-01
   35   parent     2.85  3.080e+00 -2.302e-01
   35   parent     2.91  3.080e+00 -1.702e-01
   50   parent     0.69  6.940e-01 -3.958e-03
   50   parent     0.63  6.940e-01 -6.396e-02
   75   parent     0.05  5.789e-02 -7.888e-03
   75   parent     0.06  5.789e-02  2.112e-03
  100   parent       NA  4.829e-03         NA
  100   parent       NA  4.829e-03         NA
  120   parent       NA  6.620e-04         NA
  120   parent       NA  6.620e-04         NA
    0       m1     0.00 -7.105e-15  7.105e-15
    0       m1     0.00 -7.105e-15  7.105e-15
    1       m1     4.84  4.821e+00  1.851e-02
    1       m1     5.64  4.821e+00  8.185e-01
    3       m1    12.91  1.307e+01 -1.567e-01
    3       m1    12.96  1.307e+01 -1.067e-01
    7       m1    22.97  2.510e+01 -2.131e+00
    7       m1    24.47  2.510e+01 -6.311e-01
   14       m1    41.69  3.672e+01  4.969e+00
   14       m1    33.21  3.672e+01 -3.511e+00
   21       m1    44.37  4.165e+01  2.722e+00
   21       m1    46.44  4.165e+01  4.792e+00
   35       m1    41.22  4.327e+01 -2.049e+00
   35       m1    37.95  4.327e+01 -5.319e+00
   50       m1    41.19  4.117e+01  1.636e-02
   50       m1    40.01  4.117e+01 -1.164e+00
   75       m1    40.09  3.643e+01  3.659e+00
   75       m1    33.85  3.643e+01 -2.581e+00
  100       m1    31.04  3.200e+01 -9.561e-01
  100       m1    33.13  3.200e+01  1.134e+00
  120       m1    25.15  2.882e+01 -3.674e+00
  120       m1    33.31  2.882e+01  4.486e+00
</div>
<div class='input'>f.w.mean.irls &lt;- mkinfit(SFO_SFO.ff, FOCUS_2006_D, weight = &quot;mean&quot;,
                         reweight.method = &quot;obs&quot;)
</div>
<div class='output'>Model cost at call  1 :  24.38274 
Model cost at call  3 :  24.38274 
Model cost at call  5 :  24.38274 
Model cost at call  7 :  23.62652 
Model cost at call  8 :  23.62652 
Model cost at call  10 :  23.62652 
Model cost at call  13 :  9.539918 
Model cost at call  14 :  9.539918 
Model cost at call  16 :  9.539918 
Model cost at call  18 :  1.339285 
Model cost at call  19 :  1.339285 
Model cost at call  20 :  1.339285 
Model cost at call  24 :  1.151215 
Model cost at call  26 :  1.151215 
Model cost at call  29 :  1.126803 
Model cost at call  30 :  1.126803 
Model cost at call  31 :  1.126803 
Model cost at call  34 :  0.9833148 
Model cost at call  35 :  0.9833148 
Model cost at call  40 :  0.8516604 
Model cost at call  41 :  0.8516604 
Model cost at call  44 :  0.8516604 
Model cost at call  45 :  0.602075 
Model cost at call  46 :  0.602075 
Model cost at call  50 :  0.3871767 
Model cost at call  51 :  0.3871767 
Model cost at call  55 :  0.3478134 
Model cost at call  56 :  0.3478134 
Model cost at call  60 :  0.347807 
Model cost at call  61 :  0.347807 
Model cost at call  65 :  0.347807 
IRLS based on variance estimates for each observed variable
Initial variance estimates are:
  parent       m1 
11.59564  7.39776 
Iteration 1 yields variance estimates:
   parent        m1 
11.573623  7.407732 
Sum of squared differences to last variance estimates: 1.4e-05 
Iteration 2 yields variance estimates:
   parent        m1 
11.573409  7.407844 
Sum of squared differences to last variance estimates: 1.4e-09 
</div>
<div class='input'>summary(f.w.mean.irls)
</div>
<div class='output'>mkin version:    0.9.27 
R version:       3.1.0 
Date of fit:     Thu May  8 08:28:17 2014 
Date of summary: Thu May  8 08:28:17 2014 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: mean then iterative reweighting method obs

Starting values for optimised parameters:
                  value   type transformed
parent_0       100.0000  state 100.0000000
k_parent         0.1000 deparm  -2.3025851
f_parent_to_m1   0.2000 deparm  -0.9802581
k_m1             0.1001 deparm  -2.3015856

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
               Estimate Std. Error    Lower   Upper  t value  Pr(&gt;|t|)    Pr(&gt;t)
parent_0       99.67000    1.79200 96.04000 103.300  55.6300 1.638e-36 8.189e-37
k_parent       -2.31200    0.04560 -2.40400  -2.219 -50.7000 4.448e-35 2.224e-35
f_parent_to_m1  0.03785    0.06317 -0.09027   0.166   0.5992 5.528e-01 2.764e-01
k_m1           -5.25100    0.12510 -5.50500  -4.998 -41.9900 3.522e-32 1.761e-32

Backtransformed parameters:
               Estimate     Lower     Upper
parent_0       99.67000 96.040000 1.033e+02
k_parent        0.09906  0.090310 1.087e-01
f_parent_to_m1  0.51340  0.468100 5.584e-01
k_m1            0.00524  0.004066 6.753e-03

Residual standard error: 1.054 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.399       4 15
parent     6.466       2  7
m1         4.679       2  8

Estimated disappearance times:
          DT50   DT90
parent   6.997  23.24
m1     132.282 439.43

Parameter correlation:
               parent_0 k_parent f_parent_to_m1    k_m1
parent_0         1.0000   0.5083        -0.6148 -0.1979
k_parent         0.5083   1.0000        -0.6062 -0.3894
f_parent_to_m1  -0.6148  -0.6062         1.0000  0.7417
k_m1            -0.1979  -0.3894         0.7417  1.0000

Data:
 time variable observed  predicted   residual err.irls
    0   parent    99.46  9.967e+01 -2.122e-01    3.402
    0   parent   102.04  9.967e+01  2.368e+00    3.402
    1   parent    93.50  9.027e+01  3.228e+00    3.402
    1   parent    92.50  9.027e+01  2.228e+00    3.402
    3   parent    63.23  7.405e+01 -1.082e+01    3.402
    3   parent    68.99  7.405e+01 -5.056e+00    3.402
    7   parent    52.32  4.982e+01  2.499e+00    3.402
    7   parent    55.13  4.982e+01  5.309e+00    3.402
   14   parent    27.27  2.490e+01  2.367e+00    3.402
   14   parent    26.64  2.490e+01  1.737e+00    3.402
   21   parent    11.50  1.245e+01 -9.476e-01    3.402
   21   parent    11.64  1.245e+01 -8.076e-01    3.402
   35   parent     2.85  3.110e+00 -2.600e-01    3.402
   35   parent     2.91  3.110e+00 -2.000e-01    3.402
   50   parent     0.69  7.037e-01 -1.374e-02    3.402
   50   parent     0.63  7.037e-01 -7.374e-02    3.402
   75   parent     0.05  5.913e-02 -9.134e-03    3.402
   75   parent     0.06  5.913e-02  8.663e-04    3.402
  100   parent       NA  4.969e-03         NA    3.402
  100   parent       NA  4.969e-03         NA    3.402
  120   parent       NA  6.852e-04         NA    3.402
  120   parent       NA  6.852e-04         NA    3.402
    0       m1     0.00 -7.105e-15  7.105e-15    2.722
    0       m1     0.00 -7.105e-15  7.105e-15    2.722
    1       m1     4.84  4.813e+00  2.672e-02    2.722
    1       m1     5.64  4.813e+00  8.267e-01    2.722
    3       m1    12.91  1.305e+01 -1.378e-01    2.722
    3       m1    12.96  1.305e+01 -8.779e-02    2.722
    7       m1    22.97  2.508e+01 -2.106e+00    2.722
    7       m1    24.47  2.508e+01 -6.062e-01    2.722
   14       m1    41.69  3.671e+01  4.983e+00    2.722
   14       m1    33.21  3.671e+01 -3.497e+00    2.722
   21       m1    44.37  4.165e+01  2.719e+00    2.722
   21       m1    46.44  4.165e+01  4.789e+00    2.722
   35       m1    41.22  4.329e+01 -2.069e+00    2.722
   35       m1    37.95  4.329e+01 -5.339e+00    2.722
   50       m1    41.19  4.119e+01 -3.387e-03    2.722
   50       m1    40.01  4.119e+01 -1.183e+00    2.722
   75       m1    40.09  3.644e+01  3.652e+00    2.722
   75       m1    33.85  3.644e+01 -2.588e+00    2.722
  100       m1    31.04  3.199e+01 -9.497e-01    2.722
  100       m1    33.13  3.199e+01  1.140e+00    2.722
  120       m1    25.15  2.881e+01 -3.659e+00    2.722
  120       m1    33.31  2.881e+01  4.501e+00    2.722
</div>
<div class='input'>
## &lt;strong&gt;Not run&lt;/strong&gt;: 
# # Manual weighting
# dw &lt;- FOCUS_2006_D
# errors &lt;- c(parent = 2, m1 = 1)
# dw$err.man &lt;- errors[FOCUS_2006_D$name]
# f.w.man &lt;- mkinfit(SFO_SFO.ff, dw, err = &quot;err.man&quot;)
# summary(f.w.man)
# f.w.man.irls &lt;- mkinfit(SFO_SFO.ff, dw, err = &quot;err.man&quot;,
#                        reweight.method = &quot;obs&quot;)
# summary(f.w.man.irls)
# ## &lt;strong&gt;End(Not run)&lt;/strong&gt;
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>mkinfit</li>
    </ul>
    <ul>
      <li> models </li><li> optimize </li>
    </ul> -->
      
    
    <h2>Author</h2>
    
  Johannes Ranke <jranke@uni-bremen.de>

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>