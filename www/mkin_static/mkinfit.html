<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>mkinfit. mkin 0.9-22</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="
  Johannes Ranke &lt;jranke@uni-bremen.de&gt;
">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">mkin 0.9-22</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>
  Fit a kinetic model to data with one or more state variables.
</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre>mkinfit(mkinmod, observed, parms.ini = "auto", state.ini = c(100, rep(0, length(mkinmod$diffs) - 
  1)), fixed_parms = NULL, fixed_initials = names(mkinmod$diffs)[-1], solution_type = "auto", 
      method.modFit = "Marq", control.modFit = list(), plot = FALSE, quiet = FALSE, 
      err = NULL, weight = "none", scaleVar = FALSE, atol = 1e-08, rtol = 1e-10, n.outtimes = 100, 
      reweight.method = NULL, reweight.tol = 1e-08, reweight.max.iter = 10, trace_parms = FALSE, 
      ...)</pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>mkinmod</dt>
      <dd>
    A list of class <code><a href='mkinmod.html'>mkinmod</a></code>, containing the kinetic model to be fitted to the data.
  </dd>
      <dt>observed</dt>
      <dd>
    The observed data. It has to be in the long format as described in
    <code><a href='http://www.inside-r.org/r-doc/FME/modFit'>modFit</a></code>, i.e. the first column called "name" must contain the
    name of the observed variable for each data point. The second column must
    contain the times of observation, named "time".  The third column must be
    named "value" and contain the observed values. Optionally, a further column
    can contain weights for each data point. If it is not named "err", its name
    must be passed as a further argument named <code>err</code> which is then passed
    on to <code><a href='http://www.inside-r.org/r-doc/FME/modFit'>modFit</a></code>.
  </dd>
      <dt>parms.ini</dt>
      <dd>
    A named vector of initial values for the parameters, including parameters
    to be optimised and potentially also fixed parameters as indicated by
    <code>fixed_parms</code>.  If set to "auto", initial values for rate constants
    are set to default values.  Using parameter names that are not in the model
    gives an error.

    It is possible to only specify a subset of the parameters that the model
    needs. You can use the parameter lists "bparms.ode" from a previously
    fitted model, which contains the differential equation parameters from this
    model. This works nicely if the models are nested. An example is given
    below.
  </dd>
      <dt>state.ini</dt>
      <dd>
    A named vector of initial values for the state variables of the model. In
    case the observed variables are represented by more than one model
    variable, the names will differ from the names of the observed variables
    (see <code>map</code> component of <code><a href='mkinmod.html'>mkinmod</a></code>). The default is to set
    the initial value of the first model variable to 100 and all others to 0.
  </dd>
      <dt>fixed_parms</dt>
      <dd>
    The names of parameters that should not be optimised but rather kept at the
    values specified in <code>parms.ini</code>.
  </dd>
      <dt>fixed_initials</dt>
      <dd>
    The names of model variables for which the initial state at time 0 should
    be excluded from the optimisation. Defaults to all state variables except
    for the first one.
  </dd>
      <dt>solution_type</dt>
      <dd>
    If set to "eigen", the solution of the system of differential equations is
    based on the spectral decomposition of the coefficient matrix in cases that
    this is possible. If set to "deSolve", a numerical ode solver from package
    <code><a href='http://www.inside-r.org/r-doc/deSolve/deSolve'>deSolve</a></code> is used. If set to "analytical", an analytical
    solution of the model is used. This is only implemented for simple
    degradation experiments with only one state variable, i.e. with no
    metabolites. The default is "auto", which uses "analytical" if possible,
    otherwise "eigen" if the model can be expressed using eigenvalues and
    eigenvectors, and finally "deSolve" for the remaining models (time
    dependence of degradation rates and metabolites). This argument is passed
    on to the helper function <code><a href='mkinpredict.html'>mkinpredict</a></code>.
  </dd>
      <dt>method.modFit</dt>
      <dd>
    The optimisation method passed to <code><a href='http://www.inside-r.org/r-doc/FME/modFit'>modFit</a></code>. The default "Marq"
    is the Levenberg Marquardt algorithm <code><a href='http://www.inside-r.org/r-doc/minpack.lm/nls.lm'>nls.lm</a></code> from the package
    <code>minpack.lm</code>. Often other methods need more iterations to find the
    same result. When using "Pseudo", "upper" and "lower" need to be 
    specified for the transformed parameters.
  </dd>
      <dt>control.modFit</dt>
      <dd>
    Additional arguments passed to the optimisation method used by
    <code><a href='http://www.inside-r.org/r-doc/FME/modFit'>modFit</a></code>.
  </dd>
      <dt>plot</dt>
      <dd>
    Should the observed values and the numerical solutions be plotted at each
    stage of the optimisation?
  </dd>
      <dt>quiet</dt>
      <dd>
    Suppress printing out the current model cost after each improvement?
  </dd>
      <dt>err </dt>
      <dd>either <code>NULL</code>, or the name of the column with the
    <em>error</em> estimates, used to weigh the residuals (see details of
    <code><a href='http://www.inside-r.org/r-doc/FME/modCost'>modCost</a></code>); if <code>NULL</code>, then the residuals are not weighed.
  </dd>
      <dt>weight</dt>
      <dd>
    only if <code>err</code>=<code>NULL</code>: how to weight the residuals, one of "none",
    "std", "mean", see details of <code><a href='http://www.inside-r.org/r-doc/FME/modCost'>modCost</a></code>.
  </dd>
      <dt>scaleVar</dt>
      <dd>
    Will be passed to <code><a href='http://www.inside-r.org/r-doc/FME/modCost'>modCost</a></code>. Default is not to scale Variables
    according to the number of observations.
  </dd>
      <dt>atol</dt>
      <dd>
    Absolute error tolerance, passed to <code><a href='http://www.inside-r.org/r-doc/deSolve/ode'>ode</a></code>. Default is 1e-8,
    lower than in <code><a href='http://www.inside-r.org/r-doc/deSolve/lsoda'>lsoda</a></code>.
  </dd>
      <dt>rtol</dt>
      <dd>
    Absolute error tolerance, passed to <code><a href='http://www.inside-r.org/r-doc/deSolve/ode'>ode</a></code>. Default is 1e-10,
    much lower than in <code><a href='http://www.inside-r.org/r-doc/deSolve/lsoda'>lsoda</a></code>.
  </dd>
      <dt>n.outtimes</dt>
      <dd>
    The length of the dataseries that is produced by the model prediction
    function <code><a href='mkinpredict.html'>mkinpredict</a></code>. This impacts the accuracy of
    the numerical solver if that is used (see <code>solution_type</code> argument. 
    The default value is 100.
  </dd>
      <dt>reweight.method</dt>
      <dd>
    The method used for iteratively reweighting residuals, also known
    as iteratively reweighted least squares (IRLS). Default is NULL,
    the other method implemented is called "obs", meaning that each
    observed variable is assumed to have its own variance, this is 
    estimated from the fit and used for weighting the residuals
    in each iteration until convergence of this estimate up to 
    <code>reweight.tol</code> or up to the maximum number of iterations
    specified by <code>reweight.max.iter</code>.
  </dd>
      <dt>reweight.tol</dt>
      <dd>
    Tolerance for convergence criterion for the variance components
    in IRLS fits.
  </dd>
      <dt>reweight.max.iter</dt>
      <dd>
    Maximum iterations in IRLS fits.
  </dd>
      <dt>trace_parms</dt>
      <dd>
    Should a trace of the parameter values be listed?
  </dd>
      <dt>...</dt>
      <dd>
    Further arguments that will be passed to <code><a href='http://www.inside-r.org/r-doc/FME/modFit'>modFit</a></code>. 
  </dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>This function uses the Flexible Modelling Environment package
  <code><a href='http://www.inside-r.org/r-doc/FME/FME'>FME</a></code> to create a function calculating the model cost, i.e. the 
  deviation between the kinetic model and the observed data. This model cost is
  then minimised using the Levenberg-Marquardt algorithm <code><a href='http://www.inside-r.org/r-doc/minpack.lm/nls.lm'>nls.lm</a></code>, 
  using the specified initial or fixed parameters and starting values.
  In each step of the optimsation, the kinetic model is solved using the
  function <code><a href='mkinpredict.html'>mkinpredict</a></code>. The variance of the residuals for each
  observed variable can optionally be iteratively reweighted until convergence
  using the argument <code>reweight.method = "obs"</code>.</p>
  
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>A list with "mkinfit" and "modFit" in the class attribute. 
  A summary can be obtained by <code><a href='summary.mkinfit.html'>summary.mkinfit</a></code>.</p>
  
    </div>

    <div class="Note">
      <h2>Note</h2>
      
      <p>The implementation of iteratively reweighted least squares is inspired by the
  work of the KinGUII team at Bayer Crop Science (Walter Schmitt and Zhenglei
  Gao). A similar implemention can also be found in CAKE 2.0, which is the
  other GUI derivative of mkin, sponsored by Syngenta.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'># One parent compound, one metabolite, both single first order.
SFO_SFO <- mkinmod(
  parent = list(type = "SFO", to = "m1", sink = TRUE),
  m1 = list(type = "SFO"))
# Fit the model to the FOCUS example dataset D using defaults
fit <- mkinfit(SFO_SFO, FOCUS_2006_D)
</div>
<div class='output'>Model cost at call  1 :  18994.29 
Model cost at call  3 :  18994.29 
Model cost at call  7 :  10642.61 
Model cost at call  8 :  10642.61 
Model cost at call  10 :  10642.61 
Model cost at call  12 :  7148.119 
Model cost at call  14 :  7148.118 
Model cost at call  17 :  412.0354 
Model cost at call  18 :  412.0353 
Model cost at call  22 :  371.2203 
Model cost at call  23 :  371.2203 
Model cost at call  25 :  371.2203 
Model cost at call  27 :  371.2134 
Model cost at call  28 :  371.2134 
Model cost at call  30 :  371.2134 
Model cost at call  32 :  371.2134 
</div>
<div class='input'>summary(fit)
</div>
<div class='output'>mkin version:    0.9.22 
R version:       3.0.1 
Date of fit:     Fri Oct 25 23:43:19 2013 
Date of summary: Fri Oct 25 23:43:19 2013 

Equations:
[1] d_parent = - k_parent_sink * parent - k_parent_m1 * parent
[2] d_m1 = + k_parent_m1 * parent - k_m1_sink * m1            

Method used for solution of differential equation system:
eigen 

Weighting: none

Starting values for optimised parameters:
              value   type transformed
parent_0      100.0  state  100.000000
k_parent_sink   0.1 deparm   -2.302585
k_parent_m1     0.1 deparm   -2.302585
k_m1_sink       0.1 deparm   -2.302585

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
              Estimate Std. Error  Lower   Upper
parent_0        99.600    1.61400 96.330 102.900
k_parent_sink   -3.038    0.07826 -3.197  -2.879
k_parent_m1     -2.980    0.04124 -3.064  -2.897
k_m1_sink       -5.248    0.13610 -5.523  -4.972

Backtransformed parameters:
               Estimate     Lower     Upper
parent_0      99.600000 96.330000 1.029e+02
k_parent_sink  0.047920  0.040890 5.616e-02
k_parent_m1    0.050780  0.046700 5.521e-02
k_m1_sink      0.005261  0.003992 6.933e-03

Residual standard error: 3.211 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   6.398       4 15
parent     6.827       3  6
m1         4.490       1  9

Estimated disappearance times:
          DT50   DT90
parent   7.023  23.33
m1     131.761 437.70

Estimated formation fractions:
                ff
parent_sink 0.4855
parent_m1   0.5145
m1_sink     1.0000

Parameter correlation:
              parent_0 k_parent_sink k_parent_m1 k_m1_sink
parent_0       1.00000       0.60752    -0.06625   -0.1701
k_parent_sink  0.60752       1.00000    -0.08741   -0.6253
k_parent_m1   -0.06625      -0.08741     1.00000    0.4716
k_m1_sink     -0.17006      -0.62527     0.47164    1.0000

Data:
 time variable observed predicted   residual
    0   parent    99.46 9.960e+01 -1.385e-01
    0   parent   102.04 9.960e+01  2.442e+00
    1   parent    93.50 9.024e+01  3.262e+00
    1   parent    92.50 9.024e+01  2.262e+00
    3   parent    63.23 7.407e+01 -1.084e+01
    3   parent    68.99 7.407e+01 -5.083e+00
    7   parent    52.32 4.991e+01  2.408e+00
    7   parent    55.13 4.991e+01  5.218e+00
   14   parent    27.27 2.501e+01  2.257e+00
   14   parent    26.64 2.501e+01  1.627e+00
   21   parent    11.50 1.253e+01 -1.035e+00
   21   parent    11.64 1.253e+01 -8.946e-01
   35   parent     2.85 3.148e+00 -2.979e-01
   35   parent     2.91 3.148e+00 -2.379e-01
   50   parent     0.69 7.162e-01 -2.624e-02
   50   parent     0.63 7.162e-01 -8.624e-02
   75   parent     0.05 6.074e-02 -1.074e-02
   75   parent     0.06 6.074e-02 -7.382e-04
  100   parent       NA 5.151e-03         NA
  100   parent       NA 5.151e-03         NA
  120   parent       NA 7.155e-04         NA
  120   parent       NA 7.155e-04         NA
    0       m1     0.00 7.105e-15 -7.105e-15
    0       m1     0.00 7.105e-15 -7.105e-15
    1       m1     4.84 4.803e+00  3.704e-02
    1       m1     5.64 4.803e+00  8.370e-01
    3       m1    12.91 1.302e+01 -1.140e-01
    3       m1    12.96 1.302e+01 -6.400e-02
    7       m1    22.97 2.504e+01 -2.075e+00
    7       m1    24.47 2.504e+01 -5.748e-01
   14       m1    41.69 3.669e+01  5.000e+00
   14       m1    33.21 3.669e+01 -3.480e+00
   21       m1    44.37 4.165e+01  2.717e+00
   21       m1    46.44 4.165e+01  4.787e+00
   35       m1    41.22 4.331e+01 -2.093e+00
   35       m1    37.95 4.331e+01 -5.363e+00
   50       m1    41.19 4.122e+01 -2.831e-02
   50       m1    40.01 4.122e+01 -1.208e+00
   75       m1    40.09 3.645e+01  3.643e+00
   75       m1    33.85 3.645e+01 -2.597e+00
  100       m1    31.04 3.198e+01 -9.416e-01
  100       m1    33.13 3.198e+01  1.148e+00
  120       m1    25.15 2.879e+01 -3.640e+00
  120       m1    33.31 2.879e+01  4.520e+00
</div>
<div class='input'>
# Use stepwise fitting, using optimised parameters from parent only fit, FOMC
## <strong>Not run</strong>: 
# FOMC <- mkinmod(parent = list(type = "FOMC"))
# FOMC_SFO <- mkinmod(
#   parent = list(type = "FOMC", to = "m1", sink = TRUE),
#   m1 = list(type = "SFO"))
# # Fit the model to the FOCUS example dataset D using defaults
# fit.FOMC_SFO <- mkinfit(FOMC_SFO, FOCUS_2006_D)
# # Use starting parameters from parent only FOMC fit
# fit.FOMC = mkinfit(FOMC, FOCUS_2006_D, plot=TRUE)
# fit.FOMC_SFO <- mkinfit(FOMC_SFO, FOCUS_2006_D, 
#   parms.ini = fit.FOMC$bparms.ode, plot=TRUE)
# 
# # Use stepwise fitting, using optimised parameters from parent only fit, SFORB
# SFORB <- mkinmod(parent = list(type = "SFORB"))
# SFORB_SFO <- mkinmod(
#   parent = list(type = "SFORB", to = "m1", sink = TRUE),
#   m1 = list(type = "SFO"))
# # Fit the model to the FOCUS example dataset D using defaults
# fit.SFORB_SFO <- mkinfit(SFORB_SFO, FOCUS_2006_D)
# # Use starting parameters from parent only SFORB fit (not really needed in this case)
# fit.SFORB = mkinfit(SFORB, FOCUS_2006_D)
# fit.SFORB_SFO <- mkinfit(SFORB_SFO, FOCUS_2006_D, parms.ini = fit.SFORB$bparms.ode)
# ## <strong>End(Not run)</strong>

# Weighted fits, including IRLS
SFO_SFO.ff <- mkinmod(parent = list(type = "SFO", to = "m1"),
                      m1 = list(type = "SFO"), use_of_ff = "max")
f.noweight <- mkinfit(SFO_SFO.ff, FOCUS_2006_D)
</div>
<div class='output'>Model cost at call  1 :  21685.52 
Model cost at call  4 :  18632.67 
Model cost at call  7 :  12455.41 
Model cost at call  8 :  12455.41 
Model cost at call  12 :  12331.26 
Model cost at call  13 :  12331.26 
Model cost at call  17 :  12121.57 
Model cost at call  18 :  12121.57 
Model cost at call  22 :  11726.32 
Model cost at call  23 :  11726.32 
Model cost at call  27 :  11004.96 
Model cost at call  28 :  11004.96 
Model cost at call  32 :  9567.875 
Model cost at call  33 :  9567.875 
Model cost at call  37 :  6691.557 
Model cost at call  38 :  6691.557 
Model cost at call  42 :  3256.331 
Model cost at call  43 :  3256.331 
Model cost at call  47 :  2612.699 
Model cost at call  48 :  2612.699 
Model cost at call  52 :  2571.662 
Model cost at call  53 :  2571.662 
Model cost at call  57 :  2569.511 
Model cost at call  58 :  2569.511 
Model cost at call  62 :  2569.405 
Model cost at call  63 :  2569.405 
Model cost at call  67 :  2569.4 
Model cost at call  68 :  2569.4 
Model cost at call  72 :  2569.4 
Model cost at call  77 :  2569.4 
</div>
<div class='input'>summary(f.noweight)
</div>
<div class='output'>mkin version:    0.9.22 
R version:       3.0.1 
Date of fit:     Fri Oct 25 23:43:21 2013 
Date of summary: Fri Oct 25 23:43:21 2013 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: none

Starting values for optimised parameters:
               value   type transformed
parent_0       100.0  state 100.0000000
k_parent         0.1 deparm  -2.3025851
f_parent_to_m1   0.2 deparm  -0.9802581
k_m1             0.1 deparm  -2.3025851

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
                 Estimate Std. Error Lower Upper
parent_0           84.790         NA    NA    NA
k_parent           -2.756         NA    NA    NA
f_parent_to_m1 513800.000         NA    NA    NA
k_m1               -4.214         NA    NA    NA

Backtransformed parameters:
               Estimate Lower Upper
parent_0       84.79000    NA    NA
k_parent        0.06352    NA    NA
f_parent_to_m1  1.00000    NA    NA
k_m1            0.01478    NA    NA

Residual standard error: 8.448 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   20.16       4 15
parent     17.56       2  7
m1         19.54       2  8

Estimated disappearance times:
        DT50   DT90
parent 10.91  36.25
m1     46.89 155.75

Parameter correlation:
Could not estimate covariance matrix; singular system:

Data:
 time variable observed  predicted   residual
    0   parent    99.46  8.479e+01  1.467e+01
    0   parent   102.04  8.479e+01  1.725e+01
    1   parent    93.50  7.957e+01  1.393e+01
    1   parent    92.50  7.957e+01  1.293e+01
    3   parent    63.23  7.008e+01 -6.850e+00
    3   parent    68.99  7.008e+01 -1.090e+00
    7   parent    52.32  5.436e+01 -2.036e+00
    7   parent    55.13  5.436e+01  7.741e-01
   14   parent    27.27  3.484e+01 -7.575e+00
   14   parent    26.64  3.484e+01 -8.205e+00
   21   parent    11.50  2.234e+01 -1.084e+01
   21   parent    11.64  2.234e+01 -1.070e+01
   35   parent     2.85  9.179e+00 -6.329e+00
   35   parent     2.91  9.179e+00 -6.269e+00
   50   parent     0.69  3.540e+00 -2.850e+00
   50   parent     0.63  3.540e+00 -2.910e+00
   75   parent     0.05  7.234e-01 -6.734e-01
   75   parent     0.06  7.234e-01 -6.634e-01
  100   parent       NA  1.478e-01         NA
  100   parent       NA  1.478e-01         NA
  120   parent       NA  4.149e-02         NA
  120   parent       NA  4.149e-02         NA
    0       m1     0.00 -1.421e-14  1.421e-14
    0       m1     0.00 -1.421e-14  1.421e-14
    1       m1     4.84  5.180e+00 -3.397e-01
    1       m1     5.64  5.180e+00  4.603e-01
    3       m1    12.91  1.438e+01 -1.470e+00
    3       m1    12.96  1.438e+01 -1.420e+00
    7       m1    22.97  2.880e+01 -5.834e+00
    7       m1    24.47  2.880e+01 -4.334e+00
   14       m1    41.69  4.444e+01 -2.746e+00
   14       m1    33.21  4.444e+01 -1.123e+01
   21       m1    44.37  5.190e+01 -7.534e+00
   21       m1    46.44  5.190e+01 -5.464e+00
   35       m1    41.22  5.391e+01 -1.269e+01
   35       m1    37.95  5.391e+01 -1.596e+01
   50       m1    41.19  4.816e+01 -6.966e+00
   50       m1    40.01  4.816e+01 -8.146e+00
   75       m1    40.09  3.552e+01  4.568e+00
   75       m1    33.85  3.552e+01 -1.672e+00
  100       m1    31.04  2.500e+01  6.035e+00
  100       m1    33.13  2.500e+01  8.125e+00
  120       m1    25.15  1.869e+01  6.457e+00
  120       m1    33.31  1.869e+01  1.462e+01
</div>
<div class='input'>f.irls <- mkinfit(SFO_SFO.ff, FOCUS_2006_D, reweight.method = "obs")
</div>
<div class='output'>Model cost at call  1 :  21685.52 
Model cost at call  4 :  18632.67 
Model cost at call  7 :  12455.41 
Model cost at call  8 :  12455.41 
Model cost at call  12 :  12331.26 
Model cost at call  13 :  12331.26 
Model cost at call  17 :  12121.57 
Model cost at call  18 :  12121.57 
Model cost at call  22 :  11726.32 
Model cost at call  23 :  11726.32 
Model cost at call  27 :  11004.96 
Model cost at call  28 :  11004.96 
Model cost at call  32 :  9567.875 
Model cost at call  33 :  9567.875 
Model cost at call  37 :  6691.557 
Model cost at call  38 :  6691.557 
Model cost at call  42 :  3256.331 
Model cost at call  43 :  3256.331 
Model cost at call  47 :  2612.699 
Model cost at call  48 :  2612.699 
Model cost at call  52 :  2571.662 
Model cost at call  53 :  2571.662 
Model cost at call  57 :  2569.511 
Model cost at call  58 :  2569.511 
Model cost at call  62 :  2569.405 
Model cost at call  63 :  2569.405 
Model cost at call  67 :  2569.4 
Model cost at call  68 :  2569.4 
Model cost at call  72 :  2569.4 
Model cost at call  77 :  2569.4 
IRLS based on variance estimates for each observed variable
Initial variance estimates are:
  parent       m1 
76.66712 54.06325 
Model cost at call  78 :  40 
Model cost at call  84 :  39.21305 
Model cost at call  85 :  39.21305 
Model cost at call  89 :  39.1965 
Model cost at call  90 :  39.1965 
Model cost at call  94 :  39.19584 
Model cost at call  95 :  39.19584 
Model cost at call  99 :  39.19581 
Model cost at call  100 :  39.19581 
Model cost at call  104 :  39.19581 
Iteration 1 yields variance estimates:
  parent       m1 
94.09940 42.02937 
Sum of squared differences to last variance estimates: 1.6 
Model cost at call  111 :  38.87882 
Model cost at call  112 :  38.87882 
Model cost at call  116 :  38.85509 
Model cost at call  117 :  38.85509 
Model cost at call  121 :  38.85435 
Model cost at call  122 :  38.85435 
Model cost at call  126 :  38.85432 
Model cost at call  127 :  38.85432 
Model cost at call  131 :  38.85432 
Iteration 2 yields variance estimates:
 parent      m1 
116.165  31.777 
Sum of squared differences to last variance estimates: 1.9 
Iteration 3 yields variance estimates:
   parent        m1 
137.13710  25.68105 
Sum of squared differences to last variance estimates: 1.2 
Iteration 4 yields variance estimates:
   parent        m1 
151.52688  22.99433 
Sum of squared differences to last variance estimates: 0.43 
Iteration 5 yields variance estimates:
   parent        m1 
159.42467  21.90361 
Sum of squared differences to last variance estimates: 0.11 
Iteration 6 yields variance estimates:
   parent        m1 
163.32728  21.44251 
Sum of squared differences to last variance estimates: 0.026 
Iteration 7 yields variance estimates:
   parent        m1 
165.18614  21.23823 
Sum of squared differences to last variance estimates: 0.0057 
Iteration 8 yields variance estimates:
   parent        m1 
166.05905  21.14544 
Sum of squared differences to last variance estimates: 0.0013 
Iteration 9 yields variance estimates:
   parent        m1 
166.46310  21.10314 
Sum of squared differences to last variance estimates: 0.00027 
Iteration 10 yields variance estimates:
   parent        m1 
166.65321  21.08337 
Sum of squared differences to last variance estimates: 5.9e-05 
</div>
<div class='input'>summary(f.irls)
</div>
<div class='output'>mkin version:    0.9.22 
R version:       3.0.1 
Date of fit:     Fri Oct 25 23:43:27 2013 
Date of summary: Fri Oct 25 23:43:27 2013 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: none then iterative reweighting method obs

Starting values for optimised parameters:
               value   type transformed
parent_0       100.0  state 100.0000000
k_parent         0.1 deparm  -2.3025851
f_parent_to_m1   0.2 deparm  -0.9802581
k_m1             0.1 deparm  -2.3025851

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
                 Estimate Std. Error Lower Upper
parent_0           74.960         NA    NA    NA
k_parent           -2.927         NA    NA    NA
f_parent_to_m1 513800.000         NA    NA    NA
k_m1               -4.442         NA    NA    NA

Backtransformed parameters:
               Estimate Lower Upper
parent_0       74.96000    NA    NA
k_parent        0.05357    NA    NA
f_parent_to_m1  1.00000    NA    NA
k_m1            0.01177    NA    NA

Residual standard error: 1.054 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   23.56       4 15
parent     26.02       2  7
m1         11.29       2  8

Estimated disappearance times:
        DT50   DT90
parent 12.94  42.98
m1     58.88 195.60

Parameter correlation:
Could not estimate covariance matrix; singular system:

Data:
 time variable observed predicted residual err.irls
    0   parent    99.46   74.9578  24.5022   12.902
    0   parent   102.04   74.9578  27.0822   12.902
    1   parent    93.50   71.0477  22.4523   12.902
    1   parent    92.50   71.0477  21.4523   12.902
    3   parent    63.23   63.8289  -0.5989   12.902
    3   parent    68.99   63.8289   5.1611   12.902
    7   parent    52.32   51.5171   0.8029   12.902
    7   parent    55.13   51.5171   3.6129   12.902
   14   parent    27.27   35.4068  -8.1368   12.902
   14   parent    26.64   35.4068  -8.7668   12.902
   21   parent    11.50   24.3344 -12.8344   12.902
   21   parent    11.64   24.3344 -12.6944   12.902
   35   parent     2.85   11.4945  -8.6445   12.902
   35   parent     2.91   11.4945  -8.5845   12.902
   50   parent     0.69    5.1463  -4.4563   12.902
   50   parent     0.63    5.1463  -4.5163   12.902
   75   parent     0.05    1.3484  -1.2984   12.902
   75   parent     0.06    1.3484  -1.2884   12.902
  100   parent       NA    0.3533       NA   12.902
  100   parent       NA    0.3533       NA   12.902
  120   parent       NA    0.1210       NA   12.902
  120   parent       NA    0.1210       NA   12.902
    0       m1     0.00    0.0000   0.0000    4.594
    0       m1     0.00    0.0000   0.0000    4.594
    1       m1     4.84    3.8869   0.9531    4.594
    1       m1     5.64    3.8869   1.7531    4.594
    3       m1    12.91   10.9295   1.9805    4.594
    3       m1    12.96   10.9295   2.0305    4.594
    7       m1    22.97   22.4431   0.5269    4.594
    7       m1    24.47   22.4431   2.0269    4.594
   14       m1    41.69   36.0925   5.5975    4.594
   14       m1    33.21   36.0925  -2.8825    4.594
   21       m1    44.37   43.8387   0.5313    4.594
   21       m1    46.44   43.8387   2.6013    4.594
   35       m1    41.22   48.8948  -7.6748    4.594
   35       m1    37.95   48.8948 -10.9448    4.594
   50       m1    41.19   46.7316  -5.5416    4.594
   50       m1    40.01   46.7316  -6.7216    4.594
   75       m1    40.09   38.0033   2.0867    4.594
   75       m1    33.85   38.0033  -4.1533    4.594
  100       m1    31.04   29.1492   1.8908    4.594
  100       m1    33.13   29.1492   3.9808    4.594
  120       m1    25.15   23.2370   1.9130    4.594
  120       m1    33.31   23.2370  10.0730    4.594
</div>
<div class='input'>f.w.mean <- mkinfit(SFO_SFO.ff, FOCUS_2006_D, weight = "mean")
</div>
<div class='output'>Model cost at call  1 :  28.3971 
Model cost at call  4 :  24.37942 
Model cost at call  9 :  16.21565 
Model cost at call  10 :  16.21565 
Model cost at call  14 :  16.04232 
Model cost at call  15 :  16.04232 
Model cost at call  19 :  15.7502 
Model cost at call  20 :  15.7502 
Model cost at call  24 :  15.19246 
Model cost at call  25 :  15.19246 
Model cost at call  29 :  14.16149 
Model cost at call  30 :  14.16149 
Model cost at call  34 :  12.10883 
Model cost at call  35 :  12.10883 
Model cost at call  39 :  8.019422 
Model cost at call  40 :  8.019422 
Model cost at call  44 :  2.953898 
Model cost at call  45 :  2.953898 
Model cost at call  49 :  2.278756 
Model cost at call  50 :  2.278756 
Model cost at call  54 :  2.257484 
Model cost at call  55 :  2.257484 
Model cost at call  59 :  2.256778 
Model cost at call  60 :  2.256778 
Model cost at call  64 :  2.256754 
Model cost at call  65 :  2.256754 
Model cost at call  69 :  2.256753 
Model cost at call  70 :  2.256753 
Model cost at call  74 :  2.256753 
</div>
<div class='input'>summary(f.w.mean)
</div>
<div class='output'>mkin version:    0.9.22 
R version:       3.0.1 
Date of fit:     Fri Oct 25 23:43:28 2013 
Date of summary: Fri Oct 25 23:43:28 2013 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: mean

Starting values for optimised parameters:
               value   type transformed
parent_0       100.0  state 100.0000000
k_parent         0.1 deparm  -2.3025851
f_parent_to_m1   0.2 deparm  -0.9802581
k_m1             0.1 deparm  -2.3025851

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
                Estimate Std. Error Lower Upper
parent_0          81.040         NA    NA    NA
k_parent          -2.860         NA    NA    NA
f_parent_to_m1 47920.000         NA    NA    NA
k_m1              -4.301         NA    NA    NA

Backtransformed parameters:
               Estimate Lower Upper
parent_0       81.04000    NA    NA
k_parent        0.05727    NA    NA
f_parent_to_m1  1.00000    NA    NA
k_m1            0.01355    NA    NA

Residual standard error: 0.2504 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   20.90       4 15
parent     21.31       2  7
m1         14.89       2  8

Estimated disappearance times:
        DT50  DT90
parent 12.10  40.2
m1     51.16 169.9

Parameter correlation:
Could not estimate covariance matrix; singular system:

Data:
 time variable observed predicted residual
    0   parent    99.46   81.0378  18.4222
    0   parent   102.04   81.0378  21.0022
    1   parent    93.50   76.5268  16.9732
    1   parent    92.50   76.5268  15.9732
    3   parent    63.23   68.2441  -5.0141
    3   parent    68.99   68.2441   0.7459
    7   parent    52.32   54.2710  -1.9510
    7   parent    55.13   54.2710   0.8590
   14   parent    27.27   36.3453  -9.0753
   14   parent    26.64   36.3453  -9.7053
   21   parent    11.50   24.3405 -12.8405
   21   parent    11.64   24.3405 -12.7005
   35   parent     2.85   10.9167  -8.0667
   35   parent     2.91   10.9167  -8.0067
   50   parent     0.69    4.6236  -3.9336
   50   parent     0.63    4.6236  -3.9936
   75   parent     0.05    1.1044  -1.0544
   75   parent     0.06    1.1044  -1.0444
  100   parent       NA    0.2638       NA
  100   parent       NA    0.2638       NA
  120   parent       NA    0.0839       NA
  120   parent       NA    0.0839       NA
    0       m1     0.00    0.0000   0.0000
    0       m1     0.00    0.0000   0.0000
    1       m1     4.84    4.4803   0.3597
    1       m1     5.64    4.4803   1.1597
    3       m1    12.91   12.5299   0.3801
    3       m1    12.96   12.5299   0.4301
    7       m1    22.97   25.4560  -2.4860
    7       m1    24.47   25.4560  -0.9860
   14       m1    41.69   40.2004   1.4896
   14       m1    33.21   40.2004  -6.9904
   21       m1    44.37   47.9798  -3.6098
   21       m1    46.44   47.9798  -1.5398
   35       m1    41.22   51.7643 -10.5443
   35       m1    37.95   51.7643 -13.8143
   50       m1    41.19   47.8572  -6.6672
   50       m1    40.01   47.8572  -7.8472
   75       m1    40.09   36.9762   3.1138
   75       m1    33.85   36.9762  -3.1262
  100       m1    31.04   27.0374   4.0026
  100       m1    33.13   27.0374   6.0926
  120       m1    25.15   20.7731   4.3769
  120       m1    33.31   20.7731  12.5369
</div>
<div class='input'>f.w.mean.irls <- mkinfit(SFO_SFO.ff, FOCUS_2006_D, weight = "mean",
                         reweight.method = "obs")
</div>
<div class='output'>Model cost at call  1 :  28.3971 
Model cost at call  4 :  24.37942 
Model cost at call  9 :  16.21565 
Model cost at call  10 :  16.21565 
Model cost at call  14 :  16.04232 
Model cost at call  15 :  16.04232 
Model cost at call  19 :  15.7502 
Model cost at call  20 :  15.7502 
Model cost at call  24 :  15.19246 
Model cost at call  25 :  15.19246 
Model cost at call  29 :  14.16149 
Model cost at call  30 :  14.16149 
Model cost at call  34 :  12.10883 
Model cost at call  35 :  12.10883 
Model cost at call  39 :  8.019422 
Model cost at call  40 :  8.019422 
Model cost at call  44 :  2.953898 
Model cost at call  45 :  2.953898 
Model cost at call  49 :  2.278756 
Model cost at call  50 :  2.278756 
Model cost at call  54 :  2.257484 
Model cost at call  55 :  2.257484 
Model cost at call  59 :  2.256778 
Model cost at call  60 :  2.256778 
Model cost at call  64 :  2.256754 
Model cost at call  65 :  2.256754 
Model cost at call  69 :  2.256753 
Model cost at call  70 :  2.256753 
Model cost at call  74 :  2.256753 
IRLS based on variance estimates for each observed variable
Initial variance estimates are:
   parent        m1 
112.19370  33.29231 
Iteration 1 yields variance estimates:
   parent        m1 
133.87499  26.44183 
Sum of squared differences to last variance estimates: 1.4 
Iteration 2 yields variance estimates:
   parent        m1 
149.55370  23.30488 
Sum of squared differences to last variance estimates: 0.53 
Iteration 3 yields variance estimates:
   parent        m1 
158.41033  22.03124 
Sum of squared differences to last variance estimates: 0.15 
Iteration 4 yields variance estimates:
   parent        m1 
162.84220  21.49737 
Sum of squared differences to last variance estimates: 0.034 
Iteration 5 yields variance estimates:
   parent        m1 
164.95958  21.26264 
Sum of squared differences to last variance estimates: 0.0075 
Iteration 6 yields variance estimates:
   parent        m1 
165.95303  21.15661 
Sum of squared differences to last variance estimates: 0.0016 
Iteration 7 yields variance estimates:
   parent        m1 
166.41725  21.10792 
Sum of squared differences to last variance estimates: 0.00035 
Iteration 8 yields variance estimates:
   parent        m1 
166.63359  21.08541 
Sum of squared differences to last variance estimates: 7.6e-05 
Iteration 9 yields variance estimates:
   parent        m1 
166.73340  21.07506 
Sum of squared differences to last variance estimates: 1.6e-05 
Iteration 10 yields variance estimates:
   parent        m1 
166.78030  21.07021 
Sum of squared differences to last variance estimates: 3.6e-06 
</div>
<div class='input'>summary(f.w.mean.irls)
</div>
<div class='output'>mkin version:    0.9.22 
R version:       3.0.1 
Date of fit:     Fri Oct 25 23:43:33 2013 
Date of summary: Fri Oct 25 23:43:33 2013 

Equations:
[1] d_parent = - k_parent * parent                         
[2] d_m1 = + f_parent_to_m1 * k_parent * parent - k_m1 * m1

Method used for solution of differential equation system:
eigen 

Weighting: mean then iterative reweighting method obs

Starting values for optimised parameters:
               value   type transformed
parent_0       100.0  state 100.0000000
k_parent         0.1 deparm  -2.3025851
f_parent_to_m1   0.2 deparm  -0.9802581
k_m1             0.1 deparm  -2.3025851

Fixed parameter values:
     value  type
m1_0     0 state

Optimised, transformed parameters:
                Estimate Std. Error Lower Upper
parent_0          74.940         NA    NA    NA
k_parent          -2.927         NA    NA    NA
f_parent_to_m1 47920.000         NA    NA    NA
k_m1              -4.442         NA    NA    NA

Backtransformed parameters:
               Estimate Lower Upper
parent_0       74.94000    NA    NA
k_parent        0.05358    NA    NA
f_parent_to_m1  1.00000    NA    NA
k_m1            0.01177    NA    NA

Residual standard error: 1.054 on 36 degrees of freedom

Chi2 error levels in percent:
         err.min n.optim df
All data   23.57       4 15
parent     26.03       2  7
m1         11.28       2  8

Estimated disappearance times:
        DT50   DT90
parent 12.94  42.98
m1     58.90 195.67

Parameter correlation:
Could not estimate covariance matrix; singular system:

Data:
 time variable observed predicted residual err.irls
    0   parent    99.46   74.9420  24.5180   12.913
    0   parent   102.04   74.9420  27.0980   12.913
    1   parent    93.50   71.0324  22.4676   12.913
    1   parent    92.50   71.0324  21.4676   12.913
    3   parent    63.23   63.8145  -0.5845   12.913
    3   parent    68.99   63.8145   5.1755   12.913
    7   parent    52.32   51.5044   0.8156   12.913
    7   parent    55.13   51.5044   3.6256   12.913
   14   parent    27.27   35.3968  -8.1268   12.913
   14   parent    26.64   35.3968  -8.7568   12.913
   21   parent    11.50   24.3267 -12.8267   12.913
   21   parent    11.64   24.3267 -12.6867   12.913
   35   parent     2.85   11.4901  -8.6401   12.913
   35   parent     2.91   11.4901  -8.5801   12.913
   50   parent     0.69    5.1439  -4.4539   12.913
   50   parent     0.63    5.1439  -4.5139   12.913
   75   parent     0.05    1.3476  -1.2976   12.913
   75   parent     0.06    1.3476  -1.2876   12.913
  100   parent       NA    0.3531       NA   12.913
  100   parent       NA    0.3531       NA   12.913
  120   parent       NA    0.1209       NA   12.913
  120   parent       NA    0.1209       NA   12.913
    0       m1     0.00    0.0000   0.0000    4.591
    0       m1     0.00    0.0000   0.0000    4.591
    1       m1     4.84    3.8865   0.9535    4.591
    1       m1     5.64    3.8865   1.7535    4.591
    3       m1    12.91   10.9282   1.9818    4.591
    3       m1    12.96   10.9282   2.0318    4.591
    7       m1    22.97   22.4405   0.5295    4.591
    7       m1    24.47   22.4405   2.0295    4.591
   14       m1    41.69   36.0884   5.6016    4.591
   14       m1    33.21   36.0884  -2.8784    4.591
   21       m1    44.37   43.8339   0.5361    4.591
   21       m1    46.44   43.8339   2.6061    4.591
   35       m1    41.22   48.8904  -7.6704    4.591
   35       m1    37.95   48.8904 -10.9404    4.591
   50       m1    41.19   46.7289  -5.5389    4.591
   50       m1    40.01   46.7289  -6.7189    4.591
   75       m1    40.09   38.0039   2.0861    4.591
   75       m1    33.85   38.0039  -4.1539    4.591
  100       m1    31.04   29.1523   1.8877    4.591
  100       m1    33.13   29.1523   3.9777    4.591
  120       m1    25.15   23.2413   1.9087    4.591
  120       m1    33.31   23.2413  10.0687    4.591
</div>
<div class='input'>
## <strong>Not run</strong>: 
# # Manual weighting
# dw <- FOCUS_2006_D
# errors <- c(parent = 2, m1 = 1)
# dw$err.man <- errors[FOCUS_2006_D$name]
# f.w.man <- mkinfit(SFO_SFO.ff, dw, err = "err.man")
# summary(f.w.man)
# f.w.man.irls <- mkinfit(SFO_SFO.ff, dw, err = "err.man",
#                        reweight.method = "obs")
# summary(f.w.man.irls)
# ## <strong>End(Not run)</strong>
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>mkinfit</li>
    </ul>
    <ul>
      <li> models </li><li> optimize </li>
    </ul> -->
      
    
    <h2>Author</h2>
    
  Johannes Ranke <jranke@uni-bremen.de>

    
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>